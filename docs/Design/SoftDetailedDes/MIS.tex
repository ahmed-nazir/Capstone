\documentclass[12pt, titlepage]{article}

\usepackage{amsmath, mathtools}

\usepackage[round]{natbib}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{colortbl}
\usepackage{xr}
\usepackage{hyperref}
\usepackage{longtable}
\usepackage{xfrac}
\usepackage{tabularx}
\usepackage{float}
\usepackage{siunitx}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage[section]{placeins}
\usepackage{caption}
\usepackage{fullpage}

\hypersetup{
bookmarks=true,     % show bookmarks bar?
colorlinks=true,       % false: boxed links; true: colored links
linkcolor=red,          % color of internal links (change box color with linkbordercolor)
citecolor=blue,      % color of links to bibliography
filecolor=magenta,  % color of file links
urlcolor=cyan          % color of external links
}

\usepackage{array}

\externaldocument{../../SRS/SRS}

\input{../../Comments}
\input{../../Common}

\begin{document}

\title{Module Interface Specification for \progname{}}

\author{\authname}

\date{\today}

\maketitle

\pagenumbering{roman}

\section{Revision History}

\begin{tabularx}{\textwidth}{p{3cm}p{2cm}X}
\toprule {\bf Date} & {\bf Version} & {\bf Notes}\\
\midrule
2023/01/18 & 1.0 & Final Version\\
\bottomrule
\end{tabularx}

~\newpage

\section{Symbols, Abbreviations and Acronyms}

See SRS Documentation at \url{https://github.com/ahmed-nazir/Capstone/blob/main/docs/SRS/SRS.pdf} \wss{give url}

\wss{Also add any additional symbols, abbreviations or acronyms}

\newpage

\tableofcontents

\newpage

\pagenumbering{arabic}

\section{Introduction}

The following document details the Module Interface Specifications for the Formulate system. Formulate enables teams to streamline data collection and storage, resulting in testing overhead reduction and increased control of raw test data gathered by automating aspects of the testing procedure. \\
\wss{Fill in your project name and description}



Complementary documents include the System Requirement Specifications
and Module Guide.  The full documentation and implementation can be
found at \url{https://github.com/ahmed-nazir/Capstone}.  \wss{provide the url for your repo}


~\newpage

\section{MIS \wss{Module Name}} \label{Module} \wss{Use labels for
  cross-referencing}
This section describes all the modules and their respective classes and/or functions. It should be noted that exception handling only applies to some
modules as some of them are automatically generated by external software and do not require error handling.
\wss{You can reference SRS labels, such as R\ref{R_Inputs}.}

\wss{It is also possible to use \LaTeX for hypperlinks to external documents.}

  \subsection{Module - ui\_main.py}

  \subsubsection{Description}
  Python file generated by PyQt designer which sets up the application’s window and its design

  \subsubsection{Classes}
  \textbf{Class:} Ui\_MainWindow() - Contains all methods for setting up the application’s window and its static front end design \\

    \noindent \begin{tabular}{| p{0.6\textwidth} | p{0.2\textwidth}| p{0.2\textwidth}|}
      \hline
      \rowcolor[gray]{0.9}
      Methods & Parameters & Return\\
      \hline
      setupUi() - Takes a PyQt MainWindow object and sets up it’s layout according to the ui file created in designer &Self, MainWindow [QMainWindow] & None \\
      \hline
      retranslateUi() - Sets the static text of the GUI’s buttons and labels & Self, MainWindow [QMainWindow] & None \\
      \hline
    \end{tabular}

    %AHMED - ADDED MY NEW FUNCTIONS

    %MOH PLEASE ADD YOUR NEW FUNCTIONS HERE

    \subsection{Module - ui\_functions.py}

    \subsubsection{Description}
    Imports all necessary libraries for backend functions, creates connection to database, and contains class for UI functions
    
    \subsubsection{Classes}
    \textbf{Class:} UIFunctions() - Contains the functions that are connected to buttons in the application’s UI \\
    
      \noindent \begin{tabular}{| p{0.6\textwidth} | p{0.2\textwidth}| p{0.2\textwidth}|}
        \hline
        \rowcolor[gray]{0.9}
        Methods & Parameters & Return\\
        \hline
        toggleMenu() - Handles the animation for toggling the side menu &Self, maxWidth [integer], enable [boolean] & None \\
        \hline
        login\_into\_app() - Checks if the enter username/password are valid and correct and signs user into their account & Self & None \\
        \hline
        continue\_signup() - Checks if all the sign up fields are valid and stores account/login details in database & Self & None \\
        \hline
        move\_to\_submit\_test() - Ensures that only logged in users are allow to reach the submit test page & Self & None \\
        \hline
        browse\_and\_display\_pictures() - Opens a popup where users are allowed to navigate through their file directory, select a picture, and display that picture in the UI & Self & None\\
        \hline
        upload\_test\_info() - Submits test data and user-inputed test information to the database, and uploads test picture to azure blob storage & Self & None \\
        \hline
        startTest() - Starts the test on the device and begins collecting data & Self & None\\
        \hline
        runProg() - Creates another thread which will allow the GUI to be operable while it is conducting tests & Self & None\\
        \hline
        stopTest() - Stops reading values from the Arduino and gathers all the data in a viewable table & Self & None\\
        \hline
        declineData() - Erases the data collected from the last test and does not submit it to the database & Self & None\\
        \hline
        submitData() - Submits data from the test to the Azure database & Self & None\\
        \hline
        retrieveData() - Retrieves data from the local onboard storage & Self & None\\
        \hline
        connect\_wireless() - Connects to the device via Wi-Fi & Self & None\\
        \hline
        disconnect\_wireless() - Disconnects the PC from the device Wi-Fi network & Self & None\\
        \hline
        connectWired() - Connects to the device via COM port (wired connection) & Self & None\\
        \hline
        disconnect\_wired() - Disconnects from the COM port currently connect & Self & None\\
        \hline
        view\_dashboard() - Directs user to PowerBi dashboard on their browser & Self & None\\
        \hline
        ping() - Retrieves the currently configured sensors and displays it for the user & Self & None\\
        \hline
        select\_com() - Checks the current COM ports detected and displays them in a drop down & Self & None\\
        \hline
        make\_config\_page() - Loads the saved sensors in the configuration page drop down & Self & None\\
        \hline
        autofill\_config() - Automatically fills out the fields in the sensor config menu when users select a saved sensor & Self & None\\
        \hline
        gen\_config\_sensors() - Generates the Arduino code if the fields are not empty & Self & None\\
        \hline
        saveConfiguration1() - Saves the sensor configuration for sensor 1 in savedSensors.json & Self & None\\
        \hline
        saveConfiguration2() - Saves the sensor configuration for sensor 2 in savedSensors.json & Self & None\\
        \hline
        saveConfiguration3() - Saves the sensor configuration for sensor 3 in savedSensors.json & Self & None\\
        \hline
        saveConfiguration4() - Saves the sensor configuration for sensor 4 in savedSensors.json & Self & None\\
        \hline
      \end{tabular}

  \subsubsection{Functions}
    \noindent \begin{tabular}{| p{0.6\textwidth} | p{0.2\textwidth}| p{0.2\textwidth}|}
      \hline
      \rowcolor[gray]{0.9}
      Function & Parameters & Return\\
      \hline
      hash\_new\_password() - Generates a hashed password based on the user’s inputted password & password [string] & salt [string], hashed\_pass [string] \\
      \hline
      is\_correct\_password() - Checks if inputted password matches stored password in database & salt\_hex [string], stored\_hash [string], pass\_to\_check [string] & Boolean \\
      \hline
      connect\_to\_database() - Creates a connection to the database to be able to read and write values from the application to the database & None & conn [connection object], cursor [cursor object] \\
      \hline
    \end{tabular}

  \subsubsection{Exception Handling}
  Input validation of the user information and try/except statements are the main forms of exception handling. 
  User fields for signing up are checked to ensure that they are not empty and that the password follows the 
  rules of having 8 minimum characters and includes an alphabet, number, and an non-alphanumeric character. 
  When logging in, inputted passwords are checked to ensure that they match the passwords stored in the database.
  In addition, most functions preform their work in a try statement and deal with errors in a except statement.
  Connectivity to the device and logged in state of users are checked before they are able to move to 'Start Test' and 'Submit Test' pages, respectively.
  Furthermore, checks for empty user fields or test information are checked before test data is submitted. If any of these conditions fail, an exception
  is raised which gets handled in the except statements. The except statements create an error popup with the appropriate message to signal to the user
  where they have gone wrong.  

  \subsection{Module - arduino\_code\_generator.py}
  \subsubsection{Description}
  This module generates Arduino code based on the users inputs in the configure sensors page. It produces a mainArduino.ino file which the user can use to flash their Arduino.
  \subsubsection{Classes}
    \textbf{Class:} CodeGenerator() - Contains the functions that write the Arduino code \\
    
      \noindent \begin{tabular}{| p{0.6\textwidth} | p{0.2\textwidth}| p{0.2\textwidth}|}
        \hline
        \rowcolor[gray]{0.9}
        Methods & Parameters & Return\\
        \hline
        generate() - gets the data which give information on the sensors attached and generates the mainArduino.ino file  & data & None \\
        \hline
      \end{tabular}


  \subsection{Module - main.py}

  \subsubsection{Description}
  Imports backend functions and frontend setup of GUI. This is also used to start and run the desktop application

  \subsubsection{Classes}
  \textbf{Class:} MainWindow() - Initializes a PyQt main window that is defined in ui\_main.py and connects the buttons in the desktop application’s UI to backend functions defined in ui\_functions.py \\

    \noindent \begin{tabular}{| p{0.6\textwidth} | p{0.2\textwidth}| p{0.2\textwidth}|}
      \hline
      \rowcolor[gray]{0.9}
      Methods & Parameters & Return\\
      \hline
      \_\_init\_\_() - Initializes the application and connects UI buttons to backend functions &  Self & None \\
      \hline
      changeText() - Add text to menu buttons when toggling full side menu and vice-versa & Self & None \\
      \hline
    \end{tabular}

  \subsection{Module - resource\_rc.py}

  \subsubsection{Description}
  Python file generated by PyQt resource compiler and sets up all the PyQt resources (local images) to be displayed during runtime of application
  

  \subsubsection{Functions}
  
    \noindent \begin{tabular}{| p{0.6\textwidth} | p{0.2\textwidth}| p{0.2\textwidth}|}
      \hline
      \rowcolor[gray]{0.9}
      Function & Parameters & Return\\
      \hline
      qInitResources() - Registers the raw byte data of each image to the Qt resource system &  None & None \\
      \hline
      qCleanupResources() - Unregisters the raw byte data of each image to the Qt resource system & None & None \\
      \hline
    \end{tabular}

\newpage
    \subsection{Module - mainArduino.ino}

    \subsubsection{Description}
    This module runs on the Arduino and collects all the data from the various sensors connected to it. It also takes the data and sends it to the PC wired or wirelessly.
    

  \subsubsection{Functions}
    \noindent \begin{tabular}{| p{0.6\textwidth} | p{0.2\textwidth}| p{0.2\textwidth}|}
      \hline
      \rowcolor[gray]{0.9}
      Function & Parameters & Return\\
      \hline
      setup() - Initializes all the sensors, SD card module and the serial communication lines between the PC and Wi-Fi module & None & None \\
      \hline
      loop() - This function reads data from the sensors and creates a bytestring to send to the PC & None & None \\
      \hline
      
    \end{tabular}

    \subsection{Module - mainESP8266.ino}

    \subsubsection{Description}
    This module runs on the NodeMCU (ESP8266) and allows for the Arduino to send data to it and relay that information to the PC via Wi-Fi.
    

  \subsubsection{Functions}
    \noindent \begin{tabular}{| p{0.6\textwidth} | p{0.2\textwidth}| p{0.2\textwidth}|}
      \hline
      \rowcolor[gray]{0.9}
      Function & Parameters & Return\\
      \hline
      setup() - Initializes the ESP8266 as a wireless access point so our PC can connect to it, it also initializes the serial port to allow for communication between the PC and Arduino & None & None \\
      \hline
      loop() - This function acts as a relay to pass information sent from the Arduino to the PC via TCP and also send information from the PC to the Arduino & None & None \\
      \hline
      
    \end{tabular}




\newpage



\newpage

\section{Appendix} \label{Appendix}
N/A \\
\wss{Extra information if required}

\end{document}